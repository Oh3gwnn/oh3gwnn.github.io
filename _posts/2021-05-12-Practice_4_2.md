---
title:  "ë‚®, ë°¤, ì‹¤ë‚´, ì‹¤ì™¸ êµ¬ë¶„ ëª¨ë¸"
excerpt: "100ì¥ì˜ ì‚¬ì§„ ë°ì´í„°ë¡œ íŠ¹ì„± ë¡œì§€ìŠ¤í‹± íšŒê·€ ì‹œê·¸ëª¨ì´ë“œ êµ¬í˜„"

categories:
 - AI
tags:
 - [python, machine learning]

toc: true
toc_sticky: true

date: 2021-05-12
last_modified_at: 2021-10-02
---

**100ì¥ì˜ ì‚¬ì§„ìœ¼ë¡œ 4ê°œì˜ íŠ¹ì„± ë¡œì§€ìŠ¤í‹± íšŒê·€ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ êµ¬í˜„í•˜ê¸°**

## ê¸°ë³¸ ì„¤ì •

- í•„ìˆ˜ ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°
- ê·¸ë˜í”„ ì¶œë ¥ ê´€ë ¨ ê¸°ë³¸ ì„¤ì • ì§€ì •


```python
# íŒŒì´ì¬ â‰¥3.5 í•„ìˆ˜
import sys
assert sys.version_info >= (3, 5)

# ì‚¬ì´í‚·ëŸ° â‰¥0.20 í•„ìˆ˜
import sklearn
assert sklearn.__version__ >= "0.20"

# ê³µí†µ ëª¨ë“ˆ ì„í¬íŠ¸
import numpy as np
import os

# ë…¸íŠ¸ë¶ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë™ì¼í•˜ê²Œ ìœ ì§€í•˜ê¸° ìœ„í•´
np.random.seed(42)

# ê¹”ë”í•œ ê·¸ë˜í”„ ì¶œë ¥ì„ ìœ„í•´
%matplotlib inline
import matplotlib as mpl
import matplotlib.pyplot as plt
mpl.rc('axes', labelsize=14)
mpl.rc('xtick', labelsize=12)
mpl.rc('ytick', labelsize=12)

# ê·¸ë¦¼ì„ ì €ì¥í•  ìœ„ì¹˜
PROJECT_ROOT_DIR = "."
CHAPTER_ID = "training_linear_models"
IMAGES_PATH = os.path.join(PROJECT_ROOT_DIR, "images", CHAPTER_ID)
os.makedirs(IMAGES_PATH, exist_ok=True)

def save_fig(fig_id, tight_layout=True, fig_extension="png", resolution=300):
    path = os.path.join(IMAGES_PATH, fig_id + "." + fig_extension)
    print("ê·¸ë¦¼ ì €ì¥:", fig_id)
    if tight_layout:
        plt.tight_layout()
    plt.savefig(path, format=fig_extension, dpi=resolution)
    
# ì–´ë ˆì´ ë°ì´í„°ë¥¼ csv íŒŒì¼ë¡œ ì €ì¥í•˜ê¸°
def save_data(fileName, arrayName, header=''):
    np.savetxt(fileName, arrayName, delimiter=',', header=header, comments='')
```

### ì£¼ìš” ê³¼ì œ

A. ì‚¬ì§„ì„ ë‚®ê³¼ ë°¤ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ êµ¬í˜„í•˜ë¼.

B. ì‚¬ì§„ì„ ë‚®ê³¼ ë°¤, ì‹¤ë‚´ì™€ ì‹¤ì™¸ë¡œ ë¶„ë¥˜í•˜ëŠ” ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ ëª¨ë¸ì„ ë‘ ê°œì˜ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ ì´ìš©í•˜ì—¬ êµ¬í˜„í•˜ë¼.

C. ê³¼ì œ 1ì—ì„œ êµ¬í˜„í•œ ìì‹ ì˜ ì•Œê³ ë¦¬ì¦˜ê³¼ ì‚¬ì´í‚·ëŸ°ì—ì„œ ì œê³µí•˜ëŠ” LogisticRegression ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ë¹„êµí•˜ë¼. 

ë‹¨, ëª¨ë¸ êµ¬í˜„ì— í•„ìš”í•œ ì‚¬ì§„ì„ ì§ì ‘ êµ¬í•´ì•¼ í•œë‹¤. ìµœì†Œ 100ì¥ ì´ìƒì˜ ì‚¬ì§„ í™œìš©í•´ì•¼ í•œë‹¤.


```python
!git clone https://github.com/hyoungteak/Assignment.git
```

    Cloning into 'Assignment'...
    remote: Enumerating objects: 161, done.[K
    remote: Counting objects: 100% (46/46), done.[K
    remote: Compressing objects: 100% (43/43), done.[K
    remote: Total 161 (delta 12), reused 0 (delta 0), pack-reused 115[K
    Receiving objects: 100% (161/161), 10.28 MiB | 34.53 MiB/s, done.
    Resolving deltas: 100% (13/13), done.
    

ì›ë˜ëŠ” êµ¬ê¸€ë“œë¼ì´ë¸Œì—ì„œ ë‚˜ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê°€ì ¸ì™”ì§€ë§Œ, ê¹ƒí—ˆë¸Œë¥¼ ë§Œë“¤ê³  ì´ë¯¸ì§€ 100ê°œë¥¼ ë„£ì–´ë†¨ì—ˆë‹¤.

ê¹ƒí—ˆë¸Œì—ì„œ ì œëŒ€ë¡œ ê°€ì ¸ì™”ëŠ”ì§€ "inside_day1.jpg"ë¥¼ ì¶œë ¥í•´ì„œ í™•ì¸í•´ë³´ì.


```python
from IPython.display import Image
Image('/content/Assignment/Machine Learning Assignment 4/Daynight picture/inside_day1.jpg')
```




![img_01](/images/output_10_0.jpg)



ì˜ ê°€ì ¸ì˜¨ ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ ì‚¬ì§„ì´ ë„ˆë¬´ í¬ë‹ˆ ë°ì´í„°ë¥¼ ì „ì²˜ë¦¬í•´ë³´ì.

ìš°ì„  í•˜ë‚˜ë§Œ 100X100ìœ¼ë¡œ ë§Œë“¤ì–´ë³´ì


```python
from PIL import Image
import numpy as np
import sys
import os
import csv
import matplotlib.pyplot as plt
import cv2

fname = '/content/Assignment/Machine Learning Assignment 4/Daynight picture/inside_day1.jpg'


original = cv2.imread(fname, cv2.IMREAD_COLOR)
original = cv2.resize(original, (100, 100)).flatten()
gray = cv2.imread(fname, cv2.IMREAD_GRAYSCALE)
gray = cv2.resize(gray, (100, 100)).flatten()
np_ori = np.asarray(original)
np_gray = np.asarray(gray)


plt.figure(figsize=(10,10))
plt.subplot(1, 2, 1)
plt.imshow(np_ori.reshape(100, 100, 3))
plt.axis('off')

plt.subplot(1, 2, 2)
plt.imshow(np_gray.reshape(100, 100))
plt.axis('off')
```




    (-0.5, 99.5, 99.5, -0.5)




![img_01](/images/output_12_1.png)



```python
from PIL import Image
import numpy as np
import sys
import os
import csv
import matplotlib.pyplot as plt

def createFileList(myDir, format='.jpg'):
  fileList = []
  print(myDir)
  for root, dirs, files in os.walk(myDir, topdown=False):
      for name in files:
          if name.endswith(format):
              fullName = os.path.join(root, name)
              fileList.append(fullName)
  return fileList

myFileList = createFileList('/content/Assignment/Machine Learning Assignment 4/Daynight picture/')
file_name = os.listdir('/content/Assignment/Machine Learning Assignment 4/Daynight picture/')

for file in myFileList:
    img_file = Image.open(file)

    img_file = img_file.resize((100,100))
    img_grey = img_file.convert('L')

    # Save Greyscale values
    value = np.asarray(img_grey.getdata(), dtype=np.int).reshape((img_grey.size[1], img_grey.size[0]))
    value = value.flatten()

    with open("img_pixels_grey.csv", 'a') as f:
        writer = csv.writer(f)
        writer.writerow(value)
```

    /content/Assignment/Machine Learning Assignment 4/Daynight picture/
    

ìš°ì„  ì‚¬ì§„ 100ê°œë¥¼ 100X100ë¡œ ë§Œë“¤ê³  csvíŒŒì¼ë¡œ ë§Œë“¤ì—ˆë‹¤.

ê·¸ë¦¬ê³  0~10000ê°œì˜ ìš”ì†Œë¥¼ ê°€ì§€ê³ ìˆëŠ”ë° ê° í”½ì…€ì˜ ê°’ì´ ë“¤ì–´ê°€ ìˆë‹¤.

í‘ë°± ì‚¬ì§„ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ RGBê°’ì„ ë”°ë¡œ íŠ¹ì„±ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ color ê°’ë„ ì§„í–‰í•˜ì˜€ë‹¤.

ìš°ì„  ì‚¬ì§„ì„ ê·¸ëŒ€ë¡œ ë¦¬ì‚¬ì´ì¦ˆí•˜ê³  ìƒ‰ìƒì„ ë”°ë¡œ ë½‘ì•„ì˜¤ëŠ”ê²Œ ì•ˆë˜ì„œ í´ë”ë¥¼ ìƒˆë¡œ ë§Œë“¤ê³  ìƒˆë¡œ ì‚¬ì§„ì„ ì €ì¥í•œ í›„ ì§„í–‰í•˜ì˜€ë‹¤.

ë°‘ì€ í´ë”ê°€ ì—†ì„ ê²½ìš° ìƒˆë¡œ ìƒì„±í•´ì£¼ê³  ìˆì„ ê²½ìš°ì—ëŠ” ê·¸ëƒ¥ ë„˜ì–´ê°€ëŠ” ì½”ë“œì´ë‹¤.


```python
def createFolder(directory):
    try:
        if not os.path.exists(directory):
            os.makedirs(directory)
    except OSError:
        print ('Error: Creating directory. ' +  directory)
 
createFolder('/content/Assignment/Machine Learning Assignment 4/resize picture/')
```


```python
import glob

for f in myFileList:
    img = Image.open(f)
    img_resize = img.resize((100, 100))
    title, ext = os.path.split(f)
    img_resize.save('/content/Assignment/Machine Learning Assignment 4/resize picture/re_' + ext)
```

resize picture í´ë”ì— re_"ì›ë˜ ì´ë¦„".jpgë¡œ ì €ì¥í•˜ê²Œ í•˜ëŠ” ì½”ë“œì´ë‹¤.


```python
myFileList = createFileList('/content/Assignment/Machine Learning Assignment 4/resize picture/')

for file in myFileList:
  img_file = plt.imread(file)
  blue,green,red = cv2.split(img_file)
  
  # Save values
  value1 = blue.reshape((10000, ))

  with open("img_pixels_blue.csv", 'a') as f:
      writer = csv.writer(f)
      writer.writerow(value1)

  value2 = green.reshape((10000, ))

  with open("img_pixels_green.csv", 'a') as f:
      writer = csv.writer(f)
      writer.writerow(value2)

  value3 = red.reshape((10000, ))

  with open("img_pixels_red.csv", 'a') as f:
      writer = csv.writer(f)
      writer.writerow(value3)
```

    /content/Assignment/Machine Learning Assignment 4/resize picture/
    

í‘ë°± ì‚¬ì§„ Daynightë„ ê·¸ë¬ë“¯, RGBê°’ë„ csv íŒŒì¼ë¡œ ìƒì„±í•œë‹¤.

ì°¸ê³ ë¡œ 100X100ìœ¼ë¡œ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— (10000, )ë¡œ reshape í•´ì£¼ì—ˆë‹¤.


```python
import pandas as pd
daynight = pd.read_csv('/content/img_pixels_grey.csv', header=None)
pdred = pd.read_csv('/content/img_pixels_red.csv', header=None)
pdblue = pd.read_csv('/content/img_pixels_blue.csv', header=None)
pdgreen = pd.read_csv('/content/img_pixels_green.csv', header=None)

Daynight = pd.DataFrame([daynight.sum(axis=1)/10000])
Red = pd.DataFrame([pdred.sum(axis=1)/10000])
Blue = pd.DataFrame([pdblue.sum(axis=1)/10000])
Green = pd.DataFrame([pdgreen.sum(axis=1)/10000])

Daynight = Daynight.transpose()
Red = Red.transpose()
Blue = Blue.transpose()
Green = Green.transpose()
```

sum ê°™ì€ ê²½ìš° 100X10000ì˜ íŒŒì¼ì„ 100X1ë¡œ ë§Œë“¤ì–´ ì£¼ë©° 

ë‚˜ë¨¸ì§€ëŠ” 10000ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ í‰ê·  ê°’ì„ ë‚´ì„œ í•˜ë‚˜ì˜ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤.

í–‰ê³¼ ì—´ì´ ë°˜ëŒ€ë¡œ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— transpose()ë„ í•´ì£¼ì—ˆë‹¤.


```python
Daynight
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20.7369</td>
    </tr>
    <tr>
      <th>1</th>
      <td>97.8544</td>
    </tr>
    <tr>
      <th>2</th>
      <td>153.3160</td>
    </tr>
    <tr>
      <th>3</th>
      <td>155.7763</td>
    </tr>
    <tr>
      <th>4</th>
      <td>86.3276</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>121.8520</td>
    </tr>
    <tr>
      <th>96</th>
      <td>146.6424</td>
    </tr>
    <tr>
      <th>97</th>
      <td>65.1688</td>
    </tr>
    <tr>
      <th>98</th>
      <td>25.2492</td>
    </tr>
    <tr>
      <th>99</th>
      <td>109.6289</td>
    </tr>
  </tbody>
</table>
<p>100 rows Ã— 1 columns</p>
</div>




```python
Red
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.9018</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30.7930</td>
    </tr>
    <tr>
      <th>2</th>
      <td>181.4984</td>
    </tr>
    <tr>
      <th>3</th>
      <td>121.4758</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15.2284</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>17.0507</td>
    </tr>
    <tr>
      <th>96</th>
      <td>196.2541</td>
    </tr>
    <tr>
      <th>97</th>
      <td>146.3720</td>
    </tr>
    <tr>
      <th>98</th>
      <td>38.7736</td>
    </tr>
    <tr>
      <th>99</th>
      <td>29.9100</td>
    </tr>
  </tbody>
</table>
<p>100 rows Ã— 1 columns</p>
</div>



ì´ì œ ì‹¤ë‚´ ì‹¤ì™¸ ë‚® ë°¤ íŠ¹ì„±ì„ ë§Œë“¤ê³  ì‹¶ì–´ì„œ 

ì‚¬ì§„ì˜ ì €ì¥ëœ ë‚´ìš©ì¤‘ì—ì„œ ìˆ«ìì™€ ë”°ì˜´í‘œ .jpgë¥¼ ì œê±°í–ˆë‹¤.


```python
# insideì™€ outdoor êµ¬ë¶„
a = []
for x in file_name:
    a.append(x.strip("'0123456789.jpg").replace('_day', '').replace('_night', ''))
filename = pd.DataFrame([a])
```


```python
# dayì™€ night êµ¬ë¶„
a = []
for x in file_name:
    a.append(x.strip("'0123456789.jpg").replace('inside_', '').replace('outdoor_', ''))
filename2 = pd.DataFrame([a])
```


```python
filename = filename.transpose()
filename2 = filename2.transpose()
```


```python
filename
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>outdoor</td>
    </tr>
    <tr>
      <th>1</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>2</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>3</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>4</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>96</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>97</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>98</th>
      <td>inside</td>
    </tr>
    <tr>
      <th>99</th>
      <td>inside</td>
    </tr>
  </tbody>
</table>
<p>100 rows Ã— 1 columns</p>
</div>



ì´ì œ ì € ìœ„ì— ê°’ì—ì„œ ì›í•«ì¸ì½”ë”©ì„ í•´ë³´ì.


```python
from sklearn.preprocessing import OneHotEncoder

cat_encoder = OneHotEncoder(sparse=False)
day_cat_1hot = cat_encoder.fit_transform(filename)
ins_cat_1hot = cat_encoder.fit_transform(filename2)
```


```python
filename = pd.DataFrame((day_cat_1hot),
             columns=['day', 'night']
             )
filename2 = pd.DataFrame((ins_cat_1hot),
             columns=['inside', 'outdoor']
             )
```

ì˜ ì €ì¥ë˜ì—ˆë‹¤. ì´ì œ ì•„ê¹Œ ì‚¬ì§„ì„ ë‚˜ëˆˆ ê°’ì„ ë¶™ì´ì.


```python
print(filename)
print(filename2)
```

        day  night
    0   0.0    1.0
    1   1.0    0.0
    2   1.0    0.0
    3   1.0    0.0
    4   1.0    0.0
    ..  ...    ...
    95  1.0    0.0
    96  1.0    0.0
    97  1.0    0.0
    98  1.0    0.0
    99  1.0    0.0
    
    [100 rows x 2 columns]
        inside  outdoor
    0      0.0      1.0
    1      1.0      0.0
    2      1.0      0.0
    3      1.0      0.0
    4      0.0      1.0
    ..     ...      ...
    95     1.0      0.0
    96     1.0      0.0
    97     0.0      1.0
    98     0.0      1.0
    99     0.0      1.0
    
    [100 rows x 2 columns]
    


```python
result = pd.concat([filename, filename2],axis=1)
result['grey_value'] = Daynight
result['red_value'] = Red
result['blue_value'] = Blue
result['green_value'] = Green
```


```python
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>day</th>
      <th>night</th>
      <th>inside</th>
      <th>outdoor</th>
      <th>grey_value</th>
      <th>red_value</th>
      <th>blue_value</th>
      <th>green_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>20.7369</td>
      <td>18.9018</td>
      <td>40.3530</td>
      <td>28.8365</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>97.8544</td>
      <td>30.7930</td>
      <td>2.6830</td>
      <td>16.0423</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>153.3160</td>
      <td>181.4984</td>
      <td>200.6854</td>
      <td>192.9094</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>155.7763</td>
      <td>121.4758</td>
      <td>89.5200</td>
      <td>134.7419</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>86.3276</td>
      <td>15.2284</td>
      <td>17.8019</td>
      <td>16.1491</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>121.8520</td>
      <td>17.0507</td>
      <td>23.3901</td>
      <td>20.4376</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>146.6424</td>
      <td>196.2541</td>
      <td>137.0802</td>
      <td>165.0893</td>
    </tr>
    <tr>
      <th>97</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>65.1688</td>
      <td>146.3720</td>
      <td>146.7012</td>
      <td>146.6713</td>
    </tr>
    <tr>
      <th>98</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>25.2492</td>
      <td>38.7736</td>
      <td>13.1340</td>
      <td>28.0879</td>
    </tr>
    <tr>
      <th>99</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>109.6289</td>
      <td>29.9100</td>
      <td>33.6793</td>
      <td>32.4805</td>
    </tr>
  </tbody>
</table>
<p>100 rows Ã— 8 columns</p>
</div>



ë°ì´í„°í”„ë ˆì„ì´ ì™„ì„±ë˜ì—ˆë‹¤.

ë§Œë“¤ì–´ì§„ íŠ¹ì„±ë“¤ë¡œ ë¡œì§€ìŠ¤í‹±íšŒê·€ë¥¼ ì§„í–‰í•´ë³´ì.


```python
y = result['grey_value'].copy()
X = result.drop("grey_value", axis=1)
```


```python
from sklearn.model_selection import RandomizedSearchCV
from scipy.stats import randint
from sklearn.ensemble import RandomForestRegressor

param_distribs = {
        'n_estimators': randint(low=1, high=100),
        'max_features': randint(low=1, high=8),
    }

forest_reg = RandomForestRegressor(random_state=42)
rnd_search = RandomizedSearchCV(forest_reg, param_distributions=param_distribs,
                                n_iter=10, cv=5, scoring='neg_mean_squared_error', random_state=42)
rnd_search.fit(X, y)
```




    RandomizedSearchCV(cv=5, error_score=nan,
                       estimator=RandomForestRegressor(bootstrap=True,
                                                       ccp_alpha=0.0,
                                                       criterion='mse',
                                                       max_depth=None,
                                                       max_features='auto',
                                                       max_leaf_nodes=None,
                                                       max_samples=None,
                                                       min_impurity_decrease=0.0,
                                                       min_impurity_split=None,
                                                       min_samples_leaf=1,
                                                       min_samples_split=2,
                                                       min_weight_fraction_leaf=0.0,
                                                       n_estimators=100,
                                                       n_jobs=None, oob_score=Fals...
                                                       warm_start=False),
                       iid='deprecated', n_iter=10, n_jobs=None,
                       param_distributions={'max_features': <scipy.stats._distn_infrastructure.rv_frozen object at 0x7fdc2826a790>,
                                            'n_estimators': <scipy.stats._distn_infrastructure.rv_frozen object at 0x7fdc28351050>},
                       pre_dispatch='2*n_jobs', random_state=42, refit=True,
                       return_train_score=False, scoring='neg_mean_squared_error',
                       verbose=0)




```python
cvres = rnd_search.cv_results_
for mean_score, params in zip(cvres["mean_test_score"], cvres["params"]):
    print(np.sqrt(-mean_score), params)
```

    27.41390642027651 {'max_features': 7, 'n_estimators': 52}
    27.089818567088134 {'max_features': 5, 'n_estimators': 15}
    27.000558306750957 {'max_features': 3, 'n_estimators': 72}
    26.816869324837555 {'max_features': 5, 'n_estimators': 21}
    27.24316319299315 {'max_features': 7, 'n_estimators': 83}
    27.1275107676489 {'max_features': 7, 'n_estimators': 75}
    26.993179773625222 {'max_features': 3, 'n_estimators': 88}
    26.809595097343074 {'max_features': 5, 'n_estimators': 24}
    26.581324816796823 {'max_features': 3, 'n_estimators': 22}
    31.050528044906496 {'max_features': 5, 'n_estimators': 2}
    


```python
from sklearn.metrics import mean_squared_error

final_model = rnd_search.best_estimator_
final_predictions = final_model.predict(X)

# RMSE í‰ê°€
final_mse = mean_squared_error(y, final_predictions)
final_rmse = np.sqrt(final_mse)
```

ë°ì´í„° ì„¸íŠ¸ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•œ ìµœì¢… ì„±ëŠ¥(RMSE)ì€ ì•„ë˜ì™€ ê°™ë‹¤.


```python
final_rmse
```




    9.788665921231017



ì–»ì–´ì§„ í…ŒìŠ¤íŠ¸ RMSEì— ëŒ€í•œ 95% ì‹ ë¢° êµ¬ê°„ì„ ê³„ì‚°í•˜ì—¬ í™•ë¥ ì ìœ¼ë¡œ ì‹œìŠ¤í…œì˜ ì„±ëŠ¥ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤.

- `scipy`ì˜ `stats` ëª¨ë“ˆ í™œìš©
- ì•„ë˜ ì½”ë“œëŠ” t-ë¶„í¬ë¥¼ ì´ìš©í•˜ì—¬ ì‹ ë¢°êµ¬ê°„ ê³„ì‚°


```python
from scipy import stats

confidence = 0.95
squared_errors = (final_predictions - y) ** 2
np.sqrt(stats.t.interval(confidence, len(squared_errors) - 1,
                         loc=squared_errors.mean(),
                         scale=stats.sem(squared_errors)))
```




    array([ 8.24667635, 11.11882593])



ìˆ˜ì •ì— ìˆ˜ì •ì„ ê±°ë“­í•´ì„œ ê²¨ìš° íŠ¹ì„± ê°’ì„ ë§Œë“¤ì–´ ë‚¼ ìˆ˜ ìˆì—ˆëŠ”ë°

ëª¨ë¸ í›ˆë ¨ ë°©ë²•ì´ ì¡°ê¸ˆ ì‹œê°„ì´ ê±¸ë¦´ ê²ƒ ê°™ë‹¤.

ê³„ì†í•´ì„œ ìˆ˜ì •í•´ ë‚˜ê°ˆ ê²ƒì´ë‹¤.
